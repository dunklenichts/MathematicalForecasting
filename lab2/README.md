# Задание №2. Линейная регрессия: построение, оценка адекватности и тюнинг

### Цель работы:
Целью данной лабораторной работы является разработка программы для построения и оценки линейной многофакторной модели (ЛМФМ) на основе временных рядов. Программа должна выполнять чтение данных из текстового файла, анализировать параметры модели, отбирать значимые факторы и проводить оценку её адекватности. Кроме того, программа должна позволять пользователю выполнять предсказания на основе построенной модели, а также оценивать её эффективность с использованием различных статистических методов.

### Задача:
1. Чтение данных: Реализовать считывание временных рядов отклика ( y ) и факторов ( X ) из текстового файла.
2. Оценка параметров ЛМФМ: Построить линейную многофакторную модель и оценить её параметры (коэффициенты и значимость).
3. Отбор значимых факторов: Использовать статистические критерии для отбора значимых факторов:

    - Оценка статистической значимости факторов с использованием уровня значимости (выбирается пользователем).
    - Оценка коэффициентов корреляции для выявления взаимосвязей между факторами и откликом.
    - Определение целесообразности исключения факторов.
4. Оценка адекватности модели:
    - Вычисление коэффициента детерминации ( R^2 ) и F-статистики.
    - Проверка адекватности модели на основе статистической значимости.
    - Оценка модели с использованием ошибок (например, RMSE).
5. Предсказания на новых данных: Реализовать возможность выполнения предсказаний для новых данных на основе построенной модели.
6. Вывод результатов: Сохранить текстовые результаты выполнения программы в файл и выводить графики зависимости фактора от отклика.
7. Дополнительные задачи:
    - Использование временных лагов для факторов (сдвиг по времени) и выделение подотрезков из временного ряда для анализа.


### Краткое описание модели:
Для построения линейной многофакторной модели (ЛМФМ) используется метод наименьших квадратов (OLS), который позволяет оценить влияние различных факторов ( X_1, X_2, ..., X_k ) на отклик ( y ). Линейная модель описывается уравнением:

$y = beta_0 + beta_1X_1 + beta_2X_2 + ... + beta_kX_k + \epsilon\$, 

где
- $y$  — отклик (зависимая переменная),
- $X_1, X_2, ..., X_k$ — факторы (независимые переменные),
- $\beta_0, \beta_1, ..., \beta_k$ — коэффициенты модели, которые необходимо оценить,
- $\epsilon$ — ошибка модели.

Процесс построения модели включает следующие этапы:

1. Подготовка данных:
    - Чтение данных из текстового файла.
    - Преобразование данных (например, преобразование строковых данных в числовые, работа с пропущенными значениями).
2. Оценка значимости факторов:
    - Для каждого фактора оценивается его коэффициент и p-значение.
    - Значимость факторов определяется на основе заданного пользователем уровня значимости.
3. Корреляция факторов:
    - Строится матрица корреляций для всех факторов, чтобы выявить взаимосвязи между ними, а также корреляцию между факторами и откликом.
4. Оценка адекватности модели:
    - Вычисляется коэффициент детерминации ( R^2 ), который показывает, какая доля вариации отклика объясняется факторами.
    - Вычисляется F-статистика для проверки статистической значимости модели.
    - Оценка ошибок с помощью различных метрик (например, RMSE) для понимания качества модели.
5. Предсказания:
    - На основе построенной модели можно делать предсказания для новых данных, введенных пользователем.
    - Результаты предсказаний сохраняются в текстовом файле.
6. Гиперпараметры и тюнинг:
    - Проводится тестирование модели с использованием различных вариантов временных лагов и выборок данных.
    - Модель настраивается с учетом этих факторов для минимизации ошибки и улучшения предсказаний.

## Бонусное задание
**Задание**: Использовать временные лаги для факторов, что позволяет моделировать зависимости в ряду с учётом временных отставаний (например, фактор $X_i$ на $t - k$-м моменте времени). Выделять подотрезки из исходного ряда отклика $y$ и факторов $X$ для дальнейшего анализа, чтобы выявить закономерности на определённых участках ряда.

## Ожидаемые результаты
- Построение линейной многофакторной модели.
- Оценка значимости факторов, адекватности модели и точности предсказаний.
- Вывод текстовых результатов в файл и визуализация графиков для анализа и демонстрации работы программы.
- Тюнинг модели с учетом временных лагов и выделения подотрезков ряда.

## Построение модели:
1. Добавление матрицы признаков, включая все столбцы, кроме целевой переменной 'Returning.Visits' и столбца с датами. Зависимая переменная y_train представляет собой значения 'Returning.Visits'.
2. Добавление константы
3. Создание и обучение модель с использованием линейной регрессии (OLS — Ordinary Least Squares)
![Снимок экрана 2024-12-11 161503](https://github.com/user-attachments/assets/1fcf8daf-3954-4581-abfd-ab8cadaf94b8)

![Снимок экрана 2024-12-11 161503](https://github.com/user-attachments/assets/db60460e-3371-49f8-9651-53e427b0c1b5)

![Снимок экрана 2024-12-11 161503](https://github.com/user-attachments/assets/cdb7240b-ac0a-4197-acef-a58c3dd1ae31)


